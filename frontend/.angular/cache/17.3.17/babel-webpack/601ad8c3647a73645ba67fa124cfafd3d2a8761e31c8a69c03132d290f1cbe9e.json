{"ast":null,"code":"import { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nexport class JwtInterceptor {\n  constructor() {}\n  intercept(request, next) {\n    // 从 localStorage 获取 token\n    const token = localStorage.getItem(environment.tokenKey);\n    // 如果有 token 且请求是到我们的 API\n    if (token && this.isApiUrl(request)) {\n      request = request.clone({\n        setHeaders: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n    }\n    return next.handle(request);\n  }\n  /**\n   * 检查是否是 API 请求\n   */\n  isApiUrl(request) {\n    return request.url.startsWith(environment.apiUrl) || request.url.startsWith(environment.pythonApiUrl);\n  }\n  static {\n    this.ɵfac = function JwtInterceptor_Factory(t) {\n      return new (t || JwtInterceptor)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: JwtInterceptor,\n      factory: JwtInterceptor.ɵfac\n    });\n  }\n}","map":{"version":3,"names":["environment","JwtInterceptor","constructor","intercept","request","next","token","localStorage","getItem","tokenKey","isApiUrl","clone","setHeaders","Authorization","handle","url","startsWith","apiUrl","pythonApiUrl","factory","ɵfac"],"sources":["D:\\code\\PersonalMoneyFlow\\frontend\\src\\app\\core\\interceptors\\jwt.interceptor.ts"],"sourcesContent":["// jwt.interceptor.ts - JWT Token 拦截器（修复版）\nimport { Injectable } from '@angular/core';\nimport {\n  HttpRequest,\n  HttpHandler,\n  HttpEvent,\n  HttpInterceptor\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { environment } from '../../../environments/environment';\n\n@Injectable()\nexport class JwtInterceptor implements HttpInterceptor {\n\n  constructor() {}\n\n  intercept(request: HttpRequest<unknown>, next: HttpHandler): Observable<HttpEvent<unknown>> {\n    // 从 localStorage 获取 token\n    const token = localStorage.getItem(environment.tokenKey);\n\n    // 如果有 token 且请求是到我们的 API\n    if (token && this.isApiUrl(request)) {\n      request = request.clone({\n        setHeaders: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n    }\n\n    return next.handle(request);\n  }\n\n  /**\n   * 检查是否是 API 请求\n   */\n  private isApiUrl(request: HttpRequest<any>): boolean {\n    return request.url.startsWith(environment.apiUrl) || \n           request.url.startsWith(environment.pythonApiUrl);\n  }\n}\n"],"mappings":"AASA,SAASA,WAAW,QAAQ,mCAAmC;;AAG/D,OAAM,MAAOC,cAAc;EAEzBC,YAAA,GAAe;EAEfC,SAASA,CAACC,OAA6B,EAAEC,IAAiB;IACxD;IACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAACR,WAAW,CAACS,QAAQ,CAAC;IAExD;IACA,IAAIH,KAAK,IAAI,IAAI,CAACI,QAAQ,CAACN,OAAO,CAAC,EAAE;MACnCA,OAAO,GAAGA,OAAO,CAACO,KAAK,CAAC;QACtBC,UAAU,EAAE;UACVC,aAAa,EAAE,UAAUP,KAAK;;OAEjC,CAAC;;IAGJ,OAAOD,IAAI,CAACS,MAAM,CAACV,OAAO,CAAC;EAC7B;EAEA;;;EAGQM,QAAQA,CAACN,OAAyB;IACxC,OAAOA,OAAO,CAACW,GAAG,CAACC,UAAU,CAAChB,WAAW,CAACiB,MAAM,CAAC,IAC1Cb,OAAO,CAACW,GAAG,CAACC,UAAU,CAAChB,WAAW,CAACkB,YAAY,CAAC;EACzD;;;uBA1BWjB,cAAc;IAAA;EAAA;;;aAAdA,cAAc;MAAAkB,OAAA,EAAdlB,cAAc,CAAAmB;IAAA;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}